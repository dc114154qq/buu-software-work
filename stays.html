<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é…’åº—ä½å®¿</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header><h1>é…’åº—ä½å®¿</h1></header>

    <div class="container">
        <input type="text" class="search-box" placeholder="æœç´¢é…’åº—..." id="search-input">
        <div id="list-container"></div>
    </div>

    <nav class="bottom-nav">
        <a href="index.html" class="nav-item"><span class="nav-icon">ğŸ </span>é¦–é¡µ</a>
        <a href="pois.html" class="nav-item"><span class="nav-icon">ğŸœ</span>æ™¯ç‚¹ç¾é£Ÿ</a>
        <a href="stays.html" class="nav-item active"><span class="nav-icon">ğŸ›ï¸</span>é…’åº—ä½å®¿</a>
        <a href="route.html" class="nav-item"><span class="nav-icon">ğŸ—ºï¸</span>è·¯çº¿</a>
    </nav>

    <script>
        let allStays = [];
        const container = document.getElementById('list-container');

        function render(list) {
            container.innerHTML = '';
            list.forEach(item => {
                const address = item.location ? item.location.address : 'åœ°å€æœªçŸ¥';
                // è®¡ç®—æœ€ä½ä»·
                let minPrice = item.roomOffers?.[0]?.priceCNY || 0;
                if(item.roomOffers) {
                    minPrice = Math.min(...item.roomOffers.map(r => r.priceCNY));
                }

                // å›¾ç‰‡å¤„ç†
                let imgSrc = '';
                if (item.media && item.media.cover) {
                    imgSrc = item.media.cover;
                }
                
                container.innerHTML += `
                    <a href="detail.html?id=${item.id}" class="card">
                        <div class="card-left">
                            <img src="${imgSrc}" class="thumb-img" onerror="this.style.display='none'">
                        </div>
                        <div class="card-content">
                            <div>
                                <h4 class="card-title">${item.name}</h4>
                                <div class="card-info">â˜… ${item.rating} <span class="tag">${item.starOrLevel}</span></div>
                                <div class="card-info">ğŸ“ ${address}</div>
                            </div>
                            <div class="price" style="text-align:right">Â¥${minPrice}èµ·</div>
                        </div>
                    </a>`;
            });
        }

        fetch('./data.json').then(res => res.json()).then(data => {
            allStays = data.stays;
            render(allStays);
        });

        document.getElementById('search-input').addEventListener('input', (e) => {
            const val = e.target.value.toLowerCase();
            const filtered = allStays.filter(i => i.name.includes(val) || i.location.address.includes(val));
            render(filtered);
        });
    </script>
</body>
</html>